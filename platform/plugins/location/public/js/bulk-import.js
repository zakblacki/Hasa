(()=>{function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,o){if(!e)return;if("string"==typeof e)return t(e,o);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,o)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}$((function(){var t=$(document).find(".bulk-import"),o=t.find(".form-bulk-import"),n=o.find('button[type="submit"]'),a=[],i=function i(l){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;0===d&&t.find(".bulk-import-message").text(n.data("validating-text")),$httpClient.make().post(o.data("validate-url"),{file:l,offset:d,limit:u}).then((function(d){var u=d.data,m=u.data,f=u.message;if(m&&m.count>0)t.find(".bulk-import-message").text(f),i(l,m.offset),a=[].concat(e(a),e(m.failed));else if(a.length>0){var c=t.find("#imported-listing"),p=t.find(".show-errors"),h=$(document).find("#failure-template").html(),g="";a.forEach((function(e){g+=h.replace("__row__",e.row).replace("__errors__",e.errors.join(", "))})),p.show(),t.find(".main-form-message").show(),c.show().html(g),a=[],Botble.hideLoading(o),Botble.hideButtonLoading(n),s.removeAllFiles(),t.find(".bulk-import-message").hide()}else r(l)}))},r=function e(a){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;0===i&&(t.find(".bulk-import-message").text(n.data("importing-text")),Botble.showButtonLoading(n),Botble.showLoading(o)),$httpClient.make().post(o.data("import-url"),{file:a,offset:i,limit:r}).then((function(i){var r=i.data,l=r.data,d=r.message;l&&l.count>0?e(a,l.offset):(Botble.showSuccess(d),l.total_message&&(t.find(".main-form-message").show(),t.find(".bulk-import-message").removeClass("alert-info").addClass("alert-success").text(l.total_message),s.removeAllFiles(),Botble.hideLoading(o),Botble.hideButtonLoading(n)))}))},s=new Dropzone(".location-dropzone",{url:o.data("upload-url"),method:"post",headers:{"X-CSRF-TOKEN":o.find("input[name=_token]").val()},previewTemplate:$(document).find("#preview-template").html(),autoProcessQueue:!1,chunking:!0,chunkSize:1048576,acceptedFiles:o.find(".location-dropzone").data("mimetypes"),maxFiles:1,maxfilesexceeded:function(e){this.removeFile(e)},success:function(e,t){var o=t.data;t.message;o&&o.file_path&&i(o.file_path)}});$(document).on("submit",o,(function(e){e.preventDefault();var n=o.find("button[type=submit]");s.getQueuedFiles().length>0&&(Botble.showLoading(o),Botble.showButtonLoading(n),t.find(".bulk-import-message").removeClass("alert-success").addClass("alert-info").hide(),t.find(".show-errors").hide(),s.processQueue()),s.on("sending",(function(){t.find(".bulk-import-message").show().text(n.data("uploading-text"))})),s.on("error",(function(e,t){Botble.showError(t.message)}))}));var l=!1;$(document).on("click",".download-template",(function(e){if(e.preventDefault(),!l){var t=$(e.currentTarget),o=t.data("extension"),n=t.html();t.html(t.data("downloading")),t.addClass("text-secondary"),l=!0,$httpClient.make().withResponseType("blob").post(t.data("url"),{extension:o}).then((function(e){var o=e.data,n=document.createElement("a"),a=window.URL.createObjectURL(o);n.href=a,n.download=t.data("filename"),document.body.append(n),n.click(),n.remove(),window.URL.revokeObjectURL(a)})).finally((function(){setTimeout((function(){t.html(n),t.removeClass("text-secondary"),l=!1}),2e3)}))}})),$(document).on("submit",".form-import-available-data",(function(e){var t=$(e.currentTarget);$httpClient.make().withButtonLoading(t.find("button[type=submit]")).post(t.prop("action"),t.serialize()).then((function(e){var o=e.error,n=e.data;o?Botble.showError(n.message):(Botble.showSuccess(n.message),t[0].reset())}))}))}))})();